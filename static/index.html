<!DOCTYPE html>
<html>
<head>
    <title>Command Control</title>
    <style>
        body { font-family: monospace; padding: 20px; max-width: 800px; margin: auto; }
        input, button { font-family: monospace; padding: 5px; margin: 5px; }
        #command { width: 400px; }
        #output { background: #f0f0f0; padding: 10px; margin-top: 20px; white-space: pre-wrap; }
        .command-item { border-bottom: 1px solid #ccc; padding: 10px 0; }
        .status { font-weight: bold; }
        .pending { color: orange; }
        .running { color: blue; }
        .completed { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h2>Command Control Panel</h2>
    <div>
        <input type="text" id="command" placeholder="Enter command (e.g., ls -la)">
        <button onclick="submitCommand()">Submit</button>
        <button onclick="refreshCommands()">Refresh</button>
    </div>
    <div id="output"></div>
    
    <script>
        async function submitCommand() {
            const input = document.getElementById('command');
            const command = input.value.trim();
            
            const response = await fetch('/commands', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({command})
            });
            
            if (response.ok) {
                input.value = '';
                refreshCommands();
            }
        }
        
        async function refreshCommands() {
            const response = await fetch('/commands');
            const commands = await response.json();
            
            const output = document.getElementById('output');
            output.innerHTML = '<h3>Commands:</h3>';
            
            commands.forEach(cmd => {
                const div = document.createElement('div');
                div.className = 'command-item';
                div.innerHTML = 
                    '<div><strong>ID:</strong> ' + cmd.task_id + '</div>' +
                    '<div><strong>Command:</strong> ' + cmd.command + '</div>' +
                    '<div class="status ' + cmd.status + '"><strong>Status:</strong> ' + cmd.status + '</div>' +
                    (cmd.output ? '<div><strong>Output:</strong><pre>' + cmd.output + '</pre></div>' : '') +
                    (cmd.error ? '<div class="error"><strong>Error:</strong> ' + cmd.error + '</div>' : '');
                output.appendChild(div);
            });
        }
        
        // Auto-refresh every 2 seconds
        setInterval(refreshCommands, 2000);
        refreshCommands();
    </script>
</body>
</html>
